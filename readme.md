# metaPBT



Population based bandits ([PB2](https://arxiv.org/abs/2002.02518)
) is a genetic algorithm aimed to optimize hyperparameters of a neural network in a single training run. In this repo, we extend this idea by the two following contributions:

1.**Utilising meta data**: PB2 relies on using data from the current optimization run in order to guide exploration of the hyperparameter search space. In our implentation of MetaPBT, we also incorporate data from other related environments. The related environments are generated by maniputation of different environment variables.

2. **Utilizing Deep Kernel learning**: PB2 uses plain GPs as a surrogate. In this work, we use [deep kernels](https://arxiv.org/abs/1511.02222).



# Reproducing Experiments

The requirements can be installed using ´pip install -r requirements.txt´. 

The scripts to run experiments are automatically generated using the meta_create_context_scripts.py script. This dynmically creates scripts for different contexts given an environment, and saves them in the /{env_name}/{context_variable_changed} directory. In order to run experiments, use the automatic_job_runner.sh script.

# Report

The report which details all the findings and experimental details can be found on Zenodo: [MetaPBT](https://zenodo.org/records/16725678?token=eyJhbGciOiJIUzUxMiJ9.eyJpZCI6ImE4Njg4ZWFiLTE5Y2UtNGI1Ny1iNmU3LWUyYjNkOWZkNDlhNSIsImRhdGEiOnt9LCJyYW5kb20iOiIxMmYxYWNlZTc4MDQzMzQwMTgzZDY1NzQ2NjNiNzM0MSJ9.sA3keQRw2sEg-95lneU5oKJZ7V4CC9L2ZBLhpfUQYlBJGoLgRi8Qua7EPQhw7_myR1RtgyPhZz7f4DvoBGJDvQ)

# Experiments

## Environments
We use the LunarLander and CartPole environemnts in our experiments, varying the leg height variable and pole length respectively to create different enviroments for our meta leanring setup

![Enviroments](repo_images/envs.png)


## Results in a nutshell

We observe that using meta data can help in some cases, in particular with difficult enviroments and at the beginning with the Lunar Lander environment. However, this is not the case with the cart pole enviroment. 

We also observe more insights relating to the exploration of search space landscape, which we detail in our [report](https://zenodo.org/records/16725678?token=eyJhbGciOiJIUzUxMiJ9.eyJpZCI6ImE4Njg4ZWFiLTE5Y2UtNGI1Ny1iNmU3LWUyYjNkOWZkNDlhNSIsImRhdGEiOnt9LCJyYW5kb20iOiIxMmYxYWNlZTc4MDQzMzQwMTgzZDY1NzQ2NjNiNzM0MSJ9.sA3keQRw2sEg-95lneU5oKJZ7V4CC9L2ZBLhpfUQYlBJGoLgRi8Qua7EPQhw7_myR1RtgyPhZz7f4DvoBGJDvQ)

![Enviroments](repo_images/results.png)



